\documentclass[12pt,a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage[czech]{babel}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{hyperref}
\usepackage{setspace}
\usepackage{enumitem}

\setlength{\parskip}{0.9em}
\setlength{\parindent}{0pt}

\title{Umělá inteligence - semestrální projekt \\[0.5em]
\large Analýza dat a aplikace vybrané metody strojového učení}
\author{
    Ondřej Chalupa \\ \texttt{chaluon3@student.cvut.cz}
    \and
    Matěj Hrdlička \\ \texttt{hrdlima8@student.cvut.cz}
}
\date{\today}

\begin{document}
\maketitle

\section*{Pokyny k práci}
Tento dokument slouží jako závazná šablona reportu. Vyplňte jednotlivé sekce v uvedeném rozsahu.  \\
Práce se řeší \emph{ve dvojicích}.

Datové sady musí pocházet z \emph{reálných nebo otevřených zdrojů} (ne knihovní benchmarky jako \texttt{Iris}, \texttt{MNIST}, \texttt{Breast Cancer}, \texttt{Wine}, apod.).  \\

Je povoleno využívat nástroje generativní AI (např. ChatGPT, Copilot). V závěru práce musí být uvedeno samostatné prohlášení popisující, k čemu byla AI využita (pouze pokud byla skutečně využita) (např. konzultace postupu, generování části kódu, kontrola textu). Využití AI však nesmí nahrazovat vlastní porozumění — každý student musí být schopen při ústním zkoušení detailně vysvětlit použitou metodu, její parametry, datovou přípravu, kód i interpretaci výsledků. Nesplnění této podmínky může ovlivnit hodnocení práce i ústní část zkoušky.

Celkový doporučený rozsah textu je \emph{8–12 stran bez příloh}.  \\

% --------------------------------------------------------------------

\section{Možné otevřené zdroje dat}
\begin{itemize}[leftmargin=*]
    \item \textbf{Kaggle Datasets:} \url{https://www.kaggle.com/datasets}
    \item \textbf{Google Dataset Search:} \url{https://datasetsearch.research.google.com}
    \item \textbf{UCI Machine Learning Repository (vyjma známých benchmarků):}  \\
          \url{https://archive.ics.uci.edu}
    \item \textbf{OpenML (vyhýbat se klasickým učebnicovým datasetům):}  \\
          \url{https://www.openml.org}
    \item \textbf{Data.gov (USA):} \url{https://www.data.gov}
    \item \textbf{EU Open Data Portal:} \url{https://data.europa.eu}
    \item \textbf{České otevřené datové portály:}  \\
    \begin{itemize}
        \item \url{https://data.gov.cz}  
        \item \url{https://opendata.praha.eu}  
        \item \url{https://opendata.brno.cz}
    \end{itemize}
    \item \textbf{OpenWeather, NOAA a další meteorologická data}
    \item \textbf{GitHub repozitáře s raw daty} (např. data ze senzorů, logů apod.)
    \item \textbf{Data z vlastního okolí} (pokud nejsou osobní – např. logy z chytré domácnosti, sportovní senzorika apod.)
\end{itemize}

% --------------------------------------------------------------------

\section{Úvod}

\begin{itemize}
    \item \textbf{Stručné představení vybrané metody a problému}
    
    Tato práce se zabývá aplikací strojového učení, konkrétně metody vícevrstvého perceptronu, na oblast analýzy dopravních přestupků v hlavním městě Praze. Data o dopravních přestupcích nám přišla zajímavá. Zjistili jsme, že záznamy o dopravních přestupcích v Praze přidává buď Policie České republiky, nebo Městská policie Praha. Chtěli jsme zjistit, jestli je možné na základě toho, že víme, kdy, kde a jaký přestupek byl spáchán, určit, zda přestupek řešila Policie České republiky, nebo Městská policie Praha.

    \item \textbf{Odůvodnění výběru dat a jejich relevance}
    
    Data jsme našli na portálu Open Data hlavního města Prahy. Na základě toho, že nám data o dopravních přestupcích přišla zajímavá, jsme si vymysleli problém, který s nimi můžeme vyřešit.

    \item \textbf{Struktura práce}
    
    Práce se skládá z několika souborů. První soubor \texttt{data\_process.py} obsahuje kód, který připraví data pro trénování nebo pro použití modelu na predikci. Soubor \texttt{train.py} obsahuje kód pro vytrénování modelu na datech a \texttt{predict.py} použije model pro predikci a určí jeho přesnost.
\end{itemize}

% --------------------------------------------------------------------

\section{Popis datové sady}

% Hlavní seznam dle struktury na obrázku
\begin{itemize}[leftmargin=*]

    % 1. BOD: PŮVOD DAT
    \item \textbf{Původ dat (zdroj a odkazy)}
    
    Data pocházejí z~portálu Open Data hlavního města Prahy a jsou vedena pod názvem \emph{Dopravní přestupky MHMP}. Pro trénování modelu byla zvolena data z~roku 2023, zatímco pro validaci a testování byly využity sady z~let 2022 a 2024.
    
    \noindent \textbf{Odkazy na zdroje:}
    \begin{itemize}
        \item Rok 2022: \href{https://opendata.praha.eu/dataset/dopravni-prestupky-mhmp-2022}{Dopravní přestupky MHMP 2022}
        \item Rok 2023: \href{https://opendata.praha.eu/dataset/dopravni-prestupky-mhmp-2023}{Dopravní přestupky MHMP 2023}
        \item Rok 2024: \href{https://opendata.praha.eu/dataset/dopravni-prestupky-mhmp-2024}{Dopravní přestupky MHMP 2024}
    \end{itemize}

    % 2. BOD: ATRIBUTY, VELIKOST, ČAS
    \item \textbf{Typy atributů, velikost a časové pokrytí}
    
    Datasety pokrývají období od ledna 2022 do června 2024. Sady z~let 2022 a 2023 obsahují záznamy za celých 12 měsíců, dataset z~roku 2024 obsahuje data pouze za první polovinu roku. Celkový přehled uvádí Tabulka~\ref{tab:pocty_zaznamu}.
    
    \begin{table}[h!]
        \centering
        \caption{Přehled počtu záznamů v~jednotlivých letech}
        \label{tab:pocty_zaznamu}
        \begin{tabular}{l c r}
            \hline
            \textbf{Dataset} & \textbf{Časové pokrytí} & \textbf{Počet záznamů} \\
            \hline
            MHMP 2022 & Leden -- Prosinec & 846\,832 \\
            MHMP 2023 & Leden -- Prosinec & 946\,701 \\
            MHMP 2024 & Leden -- Červen & 372\,084 \\
            \hline
            \textbf{Celkem} & & \textbf{2\,165\,617} \\
            \hline
        \end{tabular}
    \end{table}

    Každý záznam reprezentuje jeden evidovaný přestupek. Mezi klíčové atributy patří:
    \begin{description}
        \item[Časové údaje:] Datum (\emph{2022-04-15}) a Čas (\emph{09:14}).
        \item[Lokalizace:] Místo (\emph{Lohniského 4}) a Čtvrť (\emph{Praha 5}).
        \item[Subjekty:] Oznamovatel (\emph{MPP/PČR}), Státní příslušnost (\emph{CZ}), Značka vozidla.
        \item[Právní kvalifikace:] Porušený zákon (např. \emph{§ 125d zák. č. 361/2000 Sb.}).
    \end{description}

    % 3. BOD: EXPLORATORNÍ ANALÝZA
    \item \textbf{Exploratorní analýza: statistiky, distribuce a grafy}
    
    Analýza provedená na datech z~roku 2023 odhalila následující charakteristiky:
    \begin{itemize}
        \item \textbf{Distribuční poměr oznamovatelů:} Data vykazují silnou převahu záznamů od Městské policie (MPP), která tvoří přibližně 91,6\,\% datasetu (866\,709 záznamů). Policie ČR (PČR) se podílí zbylými 8,4\,\%.
        
        \item \textbf{Geografické rozložení:} Přestupky jsou nejčastěji evidovány v~obvodech \textbf{Praha 4} (207\,400 záznamů) a \textbf{Praha 6} (167\,246 záznamů). Centrum města (Praha 1) je v~četnosti až čtvrté.
        
        \item \textbf{Typy přestupků:} Nejčastějším porušením je §~125c odst.~1 písm.~k) (nedovolené zastavení/stání). Významnou část tvoří i překročení rychlosti do 20 km/h v~obci.
        
        \item \textbf{Struktura chybějících dat:} Atributy jako Datum či Oznamovatel jsou vyplněny vždy. Nejvíce chybějících hodnot vykazuje:
        \begin{itemize}
            \item tovární značka vozidla - 12.4\%
            \item čas - 4.6\%
            \item státní příslušnost - 	2.4\%
            
        \end{itemize}
 
    \end{itemize}

    % 4. BOD: IDENTIFIKACE PROBLÉMŮ
    \item \textbf{Identifikace problémů datasetu (nevyváženost, šum, chybějící hodnoty)}
    
    Během přípravy dat byly identifikovány tyto problémy:
    
    \begin{itemize}
        \item \textbf{Vysoká nevyváženost tříd:} Poměr MPP vůči PČR je cca 11:1.
        
        \item \textbf{Nekonzistentní označování:} Atribut právní kvalifikace obsahuje duplicitní významy (např. dlouhý zápis \texttt{§ 125c odst. 1...} vs. zkrácený \texttt{§ 125c/1k...}).
        
        \item \textbf{Chybějící hodnoty:} Atribut \textit{TOVZN} (Tovární značka) chybí u~12,4\,\% záznamů, atribut \textit{CASSK} (Čas) u~4,5\,\% záznamů.
        
        \item \textbf{Nestrukturovaný text:} Atribut \textit{MISTOSK} obsahuje volný text s~překlepy a nejednotným formátováním (např.: \textit{Maltézské náměstí 16, Praha 1, u domu})
    \end{itemize}

    % 5. BOD: PROFILING
    \item \textbf{Profil dat (ydata-profiling)}
    
    Detailní automaticky generovaný profil datové sady vytvořený nástrojem \texttt{ydata-profiling} je přiložen v~Příloze~A.

\end{itemize}


% --------------------------------------------------------------------

\section{Formulace cíle}
\begin{itemize}[leftmargin=*]
    \item \textbf{Přesná formulace predikčního/klasifikačního cíle.}
    
    Hlavním cílem této semestrální práce je navrhnout, natrénovat a vyhodnotit model strojového učení, který bude schopen rozlišit, kdo zaznamenal dopravní přestupek na území hlavního města Prahy. Konkrétně se jedná o rozlišení mezi Městská policie Praha a Policie České republiky.
    \item \textbf{Typ úlohy a zdůvodnění výběru metody.}

    Z hlediska strojového učení se jedná o úlohu učení s učitelem, konkrétně o binární klasifikaci.
    Pro řešení úlohy byla zvolena metoda Vícevrstvého perceptronu. Předpokládáme že vztahy mezi vstupními daty a cílovou třídou jsou komplikované ale je v nich možné najít nějaký pattern, na základě kterého se policie pohybuje. Například ulice "Evropská" může implikovat PČR v noci (měření rychlosti), ale MPP ve dne (parkování). proto jsme zvolili metodu MLP která by tyto vztahy mohla najít.
    
\end{itemize}

% --------------------------------------------------------------------

\section{Předzpracování dat}

Tato kapitola popisuje technické kroky vedoucí k transformaci surových dat do podoby vhodné pro trénování klasifikačního modelu. Proces zahrnoval čištění dat, extrakci nových příznaků (feature engineering) a finální selekci atributů na základě jejich statistické významnosti.

\begin{itemize}[leftmargin=*]
    
    % 1. BOD: VYŘEŠENÉ PROBLÉMY
    \item \textbf{Vyřešené datové problémy a popis postupů}
    
    Na základě závěrů exploratorní analýzy byly adresovány následující nedostatky v kvalitě a struktuře dat:
    \begin{itemize}
        \item \textbf{Nestrukturovaný text u lokace:} Atribut \textit{MISTOSK} původně obsahoval volný text kombinující názvy ulic, čísla popisná a další upřesnění (např. \uv{před domem č.p. 5}). Pro potřeby modelování bylo nutné tento text kategorizovat. Pomocí regulárních výrazů a vyhledávání klíčových slov (např. \uv{tunel}, \uv{náměstí}, \uv{Evropská}, \uv{spojka}) byly záznamy rozděleny do čtyř obecných tříd: \textit{náměstí, tunel, hlavní ulice} a \textit{ostatní}.
        
        \item \textbf{Nekonzistentní zápis zákonů:} Atribut \textit{ZAKON} vykazoval vysokou variabilitu v zápisu totožných přestupků (rozdílné mezery, zkratky odstavců). Byla provedena normalizace textu, kdy byly pomocí vzorů (regex) sjednoceny varianty zápisu na základní tvar paragrafu a odstavce (např. unifikace na \texttt{§125c/1k}).
        
        \item \textbf{Chybějící a odlehlé hodnoty:} U atributu tovární značky (\textit{TOVZN}) byla chybějící data (cca 12\,\%) imputována zástupnou hodnotou \texttt{UNSPECIFIED}. V případě chybějící státní příslušnosti byla použita hodnota \texttt{UNKNOWN}. Pokud u záznamu chyběl čas nebo byl v chybném formátu, byla hodina přestupku nastavena na indikátor \texttt{-1}.
    \end{itemize}

    % 2. BOD: KROKY PŘEDZPRACOVÁNÍ
    \item \textbf{Kroky předzpracování (transformace a tvorba příznaků)}
    
    Cílem transformací bylo snížit dimenzionalitu dat a zachytit obecnější trendy namísto specifických detailů, které by mohly vést k přeučení modelu.
    
    \begin{description}
        \item[Časové atributy:] 
        Ze spojitého času byla vytvořena sada kategorických příznaků s cílem zachytit cyklické chování a trendy. Konkrétně byly derivovány:
        \begin{itemize}
            \item \textbf{Měsíc} (1--12).
            \item \textbf{Hodina} (0--11), pro chybějící čas nahrazeno hodnotou \texttt{-1}.
            \item \textbf{Typ dne} (binární rozdělení na pracovní den a víkend).
            \item \textbf{Roční období} (jaro, léto, podzim, zima).
            \item \textbf{Denní doba} (ráno, odpoledne, večer, noc); v případě chybějícího času nastaveno jako \texttt{none}.
        \end{itemize}
        
        \item[Typ vozidla (\texttt{CAR\_TYPE}):] 
        Atribut značky vozidla byl diskretizován dle předem vytvořeného seznamu nejfrekventovanějších značek (např. \textit{Škoda, Volvo, Hyundai}). Značky s nižším výskytem, které nebyly součástí seznamu, byly sloučeny do kategorie \texttt{OTHER}. Záznamy bez uvedené značky byly označeny jako \texttt{UNSPECIFIED}.
    \end{description}

    % 3. BOD: ZDŮVODNĚNÍ VÝBĚRU
    \item \textbf{Zdůvodnění výběru atributů}
    
    Finální sada atributů pro trénování byla zvolena na základě analýzy korelací a iterativního testování výkonu modelu. Byla vypočtena korelační matice (viz Obrázek~\ref{fig:corr_matrix}), která vizualizuje vztahy mezi nově vytvořenými příznaky a cílovou proměnnou \textit{OZNAM}.
    
    \begin{figure}[h!]
        \centering
        \includegraphics[width=1\textwidth]{correlation_matrix.png}
        \caption{Korelační matice finálních atributů (vizualizace závislosti mezi extrahovanými příznaky)}
        \label{fig:corr_matrix}
    \end{figure}
    
    Na základě této analýzy byly pro finální trénink modelu vybrány atributy: \texttt{SEASON}, \texttt{DAY\_TIME}, \texttt{PRAGUE}, \texttt{PLACE\_TYPE}, \texttt{CAR\_TYPE}, \texttt{LAW\_CLEAN} a \texttt{IS\_FIRM}.

\end{itemize}
% --------------------------------------------------------------------
\newpage
\section{Metoda strojového učení}
    Pro řešení úlohy byla zvolena metoda Vícevrstvého perceptronu (MLP). Jedná se o dopřednou umělou neuronovou síť (Feedforward Neural Network), která se skládá z jedné vstupní vrstvy, jedné či více skrytých vrstev a jedné výstupní vrstvy.

    Základním stavebním kamenem je umělý neuron, který provádí vážený součet svých vstupů, přičítá k němu prahovou hodnotu (bias) a výsledek transformuje pomocí nelineární aktivační funkce. Díky vrstvení těchto neuronů a použití nelinearit je MLP schopen aproximovat i velmi složité rozhodovací hranice v mnohadimenzionálním prostoru příznaků, což je pro naše kategorická data klíčové.
    
    My jsme pro vytvoření modelu jsme použili knihovnu \texttt{scikit-learn} a třídu \texttt{MLPClassifier}. Na základě experimentů s počtem neuronů a skrytých vrstev byla zvolena arhitektura s dvěmi skrytými vrtsvami. První skrytá vrstva s 50 neurony a druhá s 25 neurony. Aktivační funkce v obou vrstvách je ReLu.

% --------------------------------------------------------------------

\section{Experimenty a výsledky (2–3 strany)}

    Při tréninku jsme použili data z roku 2023. Ty byli rozdělené na trénovací (80\,\% dat) a testovací (20\,\% dat). Následně jsme pak ještě natrénovaný model testovali na datech z jiných let. Jako první jsme vytvořili model s dvěmi skrytými vrstvami se 100 neuronů v první a 50 neurony v druhé vrstvě. Tento model jsme používali při úpravě dat.
    
    Při analýze dat jsme si například všimli, že v datech často chybí značka vozidla a čas. Když jsme se podívali na to, kdo udělal záznam v řádcích s chybějícími hodnotami, tak jsme zjistili, že se z většiny jednalo o PČR. Například když chyběla značka auta, tak se z 59,4 \,\% jednalo o PČR, Když si vezmeme že rozložení záznamů PČR a MPP je v datech 1:11, tak se zdá že absence údajů je vlastně dobrý ukazatel toho, zda se jedná o PČR či nikoliv. Přidali jsme sloupce \texttt{MISSING\_TIME} a \texttt{MISSING\_BRAND}. Výsledky ale byli horší než když jsme jen do sloupců \texttt{HOUR} dali hodnotu -1 a \texttt{CAR\_TYPE} dali hodnotu \texttt{UNSPECIFIED}. Řádky s chybějícím časem a značkou auta jsme i zkusili odstranit a natrénovat model na datech bez nich. Model pak na datech pro rok 2023 a 2024 měl přesnost 99.9 \,\%. Pro rok 2022 ale jen 92 \,\%.

    Následně jsme zkusili měnit počet neuronů a vrstev a rozšířili jsme testovací data ještě o roky 2021 a 2020. Zkusili jsme natrénovat model s jednou skrytou vrstvou o 50 a poté o 100 neuronech. Následně modely s dvěmi vrstvami, jeden model o 50 neuronech v první skryté vrtsvě a 25 v druhé a jeden s původními 100 neurony v první vrstvě a 50 v druhé. 
    
    Všechny modely měli přesnost 99 \,\% při určování záznamů od MPP ale při určování PČR byla přesnost u některých modelů výrazně nižší (nejhorší 61 \,\% měl model s jednou skrytou vrstvou na datech z roku 2022). Graf Přesnosti na třídě PČR vidíme na obrázku níže.
    
    \begin{figure}[h!]
        \centering
        \includegraphics[width=1\linewidth]{precision graph.png}
        \caption{Graf přesnosti na třídě PČR}
        \label{fig:placeholder}
    \end{figure}

    nejlepších výsledků dosáhl model s 50 neurony v první a 25 neurony v druhé vrstvě.
\begin{table}[h!]
    \centering
    \caption{Přesnost modelů}
    \label{tab:precision_mode}
    % Změna definice sloupců:
    % | - svislá čára
    % >{\bfseries}c - tento sloupec (c) bude automaticky tučný
    \begin{tabular}{l|c c c c}
        \textbf{Rok} & \textbf{Model (50)} & \textbf{Model (100)} & \textbf{Model (100, 50)} & \textbf{Model (50, 25)} \\
        \hline
        2024 & 0.95 & 0.96 & 0.89 & \textbf{0.95} \\
        \hline
        2023 - trénink & 0.99 & 0.99 & 0.99 & \textbf{0.99} \\
        \hline
        2022 & 0.61 & 0.82 & 0.83 & \textbf{0.96} \\
        \hline
        2021 & 0.73 & 0.88 & 0.84 & \textbf{0.97} \\
        \hline
        2020 & 0.77 & 0.89 & 0.86 & \textbf{0.97} \\
    \end{tabular}
\end{table}

% Requires: \usepackage{multirow}
\begin{table}[h]
    \centering
    \caption{výsledky modelu(50,25)}
    \label{tab:placeholder_label}
    \begin{tabular}{lcccc}
        \textbf{Rok} & \textbf{Precision (PČR)} & \textbf{Recall (PČR)} & \textbf{F1-Score (PČR)} & \textbf{přesnost} \\
        \hline
        2024 & 0.95 & 0.94 & 0.95 & 99 \% \\
        \hline
        2023 (Trénink) & 0.99 & 0.96 & 0.98 & 100 \% \\
        \hline
        2022 & 0.96 & 0.93 & 0.95 & 99 \% \\
        \hline
        2021 & 0.97 & 0.89 & 0.93 & 98 \% \\
        \hline
        2020 & 0.97 & 0.89 & 0.93 & 99 \% \\
        
    \end{tabular}
\end{table}





% --------------------------------------------------------------------

\section{Diskuse (1 strana)}
V této části rozebíráme, proč náš model funguje, jaké má výsledky a na co jsme během práce přišli.

\begin{itemize}[leftmargin=*]
    \item \textbf{Zhodnocení silných a slabých stránek výsledku.}
    
    Největším problémem datasetu byla nevyváženost počtu záznamů PČR a MPP (11:1), což by mohlo vést k tomu, že by se model nenaučil specifické odlišnosti záznamů PČR, ale naučil by se bezhlavě hádat MPP s vizí úspěšnosti nad 90\%. S tímto problémem si ale model se dvěma vrstvami (50 a 20 neuronů) poradil, což lze pozorovat na základě těchto metrik pro rok 2024:
    
    \begin{itemize}
        \item \textbf{Precision (0,95):} Tato metrika říká, že v případech kde model označil záznam jako PČR, tak se v 95\% trefil. Pokud by se model snažil násilně vyhledávat PČR, mohlo by vzniknout více případů FP (false positive), k tomu však nedošlo.
        \item \textbf{Recall (0,94):} Recall 94\% pro třídu PČR znamená, že z celkového počtu záznamů PČR v datasetu jich model objevil 94\%. Pokud by model raději označoval MPP kvůli jejich velkému zastoupení, bylo by číslo nižší.
        \item \textbf{F1-Score (0,95):} Parametr F1-Score je harmonickým průměrem parametrů Precision a Recall. Nízká hodnota by mohla naznačovat náchylnost vůči datové nevyváženosti. Tento výsledek ale ukazuje, že náš model je proti ní velmi naopak velmi odolný.
    \end{itemize}
    Tyto hodnoty ukazují, že se nám podařilo vyřešit problém s nevyvážeností dat. Model nehádá jen naslepo většinovou třídu, ale skutečně se naučil poznat specifika státní policie.

    Další silnou stránkou modelu je, že je použitelný na záznamech ve velkém časovém rozpětí (rok 2020 až polovina roku 2024). To ukazuje že model zachytil hlubší závislosti než jen nějaké krátkodobé trendy jednoho roku. Naopak problémovou stránkou je, že model pravděpodobně velmi spoléhá pro rozpoznání PČR na neúplnost dat (PČR často nechává některá pole prázdná). Pokud by PČR změnila své návyky a začala lépe udržovat záznamy, model už by možná nebyl použitelný.

    \item \textbf{Co fungovalo a co ne, a proč.}
    
    Klíčem k úspěchu bylo nemazat neúplné řádky. Původně jsme například chtěli data s chybějícím časem vyhodit, ale ukázalo se, že právě prázdná políčka nejlépe prozrazují PČR. 
    Také se ukázalo, že jednoduchá síť na tento úkol nestačí. Model s jednou vrstvou dělal chyby. Až architektura se dvěma vrstvami (50 a 25 neuronů) dokázala zachytit složitější vztahy v datech.

    \item \textbf{Možné alternativy a budoucí vylepšení.}
    
    Nevýhodou neuronové sítě je že nevidíme přesně, proč se rozhodla tak jak se rozhodla. Není proto možné z výsledů s jistotou vyčíst nějaký patern pro rozdělení. Kdybychom chtěli větší transparentnost, mohli bychom příště zkusit \textbf{Rozhodovací stromy (Decision Trees)}. Ty by nám formou diagramu přesně ukázaly pravidla (např. „pokud chybí čas $\to$ je to PČR“), což by bylo pro vysvětlování chování policie srozumitelnější.

    Dalším vylepšením by mohlo být důkladnější zpracování dat. Například místo je určeno jednoduchým vyhledáváním klíčových slov jako je "tunel", "spojka" atd. Důmyslnějším rozdělením by třeba bylo možné lokaci rozdělit lépe a vyčíst nějaké další příznaky. 
\end{itemize}

% --------------------------------------------------------------------

\section{Závěr}

\begin{itemize}[leftmargin=*]
    \item \textbf{Shrnutí výsledků a výkonnosti modelu.}

    
    Úkolem práce bylo zpracovat data a natrénovat model schopný automaticky klasifikovat původce přestupku a rozlišit mezi Městskou policií a Policií ČR. K tomuto účelu jsme využili vícevrstvou neuronovou síť (MLP). Jako nejefektivnější se po sérii experimentů ukázal model se dvěma skrytými vrstvami o velikosti 50 a 25 neuronů.
    
    Tento model konzistentně dosahuje na datech od roku 2020 po rok 2024 přesnost nad 98\%. V letech 2020, 2022 a 2024 dokonce nad 99\%. Vysoká hodnota F1-skóre (0,95) potvrzuje, že model je spolehlivý i při detekci menšinové třídy PČR a netrpí tendencí ignorovat méně časté záznamy.

    \item \textbf{Splnění cílů práce.}
    
    Cíl práce lze považovat za úspěšně splněný. Podařilo se vytvořit plně funkční klasifikátor, který s vysokou jistotou identifikuje, zda záznam pochází od městské či státní policie.
    
    Kritickým bodem celého řešení bylo vypořádání se s výraznou nevyvážeností datasetu, kde poměr záznamů MPP ku PČR činil 11:1. Výsledné metriky potvrzují, že zvolená architektura a metoda zpracování dat tento nepoměr úspěšně kompenzovaly, aniž by došlo ke zkreslení predikcí ve prospěch dominantní třídy.

    \item \textbf{Získané poznatky a přínos.}
    
    Během vývoje jsme ověřili, že při práci s reálnými daty může být i absence informace klíčovým příznakem – v našem případě se ukázalo, že chybějící údaje v záznamech jsou silným indikátorem pro PČR.
    
    Zároveň se v praxi potvrdilo, že u silně nevyvážených dat nelze spoléhat pouze na celkovou přesnost modelu. Pro objektivní vyhodnocení kvality sítě bylo nezbytné sledovat metriky Precision a Recall, které nám poskytly jistotu, že model skutečně chápe strukturu dat a neuchyluje se k prostému statistickému hádání.
    
\end{itemize}

% --------------------------------------------------------------------

\newpage

\section*{Prohlášení o využití generativní AI (pokud relevantní)}
Tato sekce je povinná pouze v případě, že byla při zpracování projektu využita generativní umělá inteligence.
\
\textbf{Vzorové prohlášení:}
\
\begin{quote}
V rámci vypracování této semestrální práce jsme využili nástroje generativní umělé inteligence (např. ChatGPT, Gemini, Mistral, GitHub Copilot) k následujícím účelům: \
\begin{itemize}
    \item konzultace teoretického postupu a ověření správnosti vysvětlení,
    \item návrh části kódu / kontrola kódu,
    \item jazyková korektura textu.
\end{itemize}
Veškerým použitým postupům, kódu i interpretaci výsledků rozumíme a jsme schopni je samostatně vysvětlit v rámci ústního zkoušení. Současně bereme na vědomí, že plně odpovídáme za správnost obsahu, výpočtů, kódu i závěrů uvedených v této práci.
\end{quote}

\section*{Přílohy}
\begin{itemize}[leftmargin=*]
    \item Výstupy profilování dat.
    \item Vybrané části kódu.
    \item Dodatečné grafy a tabulky.
\end{itemize}

\end{document}
